#!/usr/bin/env node
"use strict";var _require=require("child_process"),execSync=_require.execSync,fadedProgressbar=require("faded-progressbar"),GitHubApi=require("github"),Promise=require("bluebird"),github=new GitHubApi({protocol:"https",host:"api.github.com",headers:{"user-agent":"git-getter"},Promise:Promise,followRedirects:!1,timeout:5e3}),args=process.argv,username=args[2],addResults=function o(e,t,s){github.getNextPage(e,null,function(e,r){30===r.data.length?o(r,t.concat(r.data),s):s(t.concat(r.data))})},downloadRepos=function(e){var r=e.filter(function(e){return!e.fork});console.log(r.length+" repositories found");var o=fadedProgressbar.newProcess("Downloading repositories",r.length);o.start(),r.forEach(function(e,r){execSync("git clone "+e.clone_url,{stdio:[0,1,2]}),o.updateProgress(r+1)})};github.repos.getForUser({username:username,type:"owner"},function(e,r){addResults(r,r.data,downloadRepos)});