#!/usr/bin/env node
"use strict";var execSync=require("child_process").execSync,fadedProgressbar=require("faded-progressbar"),GitHubApi=require("github"),github=new GitHubApi({protocol:"https",host:"api.github.com",headers:{"user-agent":"git-getter"},Promise:require("bluebird"),followRedirects:!1,timeout:5e3}),args=process.argv,username=args[2],addResults=function e(r,t,o){github.getNextPage(r,null,function(r,s){30==s.data.length?e(s,t.concat(s.data),o):o(t.concat(s.data))})},downloadRepos=function(e){var r,t=e.filter(function(e){return!e.fork});console.log(t.length+" repositories found"),(r=fadedProgressbar.newProcess("Downloading repositories",t.length)).start(),t.forEach(function(e,t){execSync("git clone "+e.clone_url,{stdio:[0,1,2]}),r.updateProgress(t+1)})};github.repos.getForUser({username:username,type:"owner"},function(e,r){addResults(r,r.data,downloadRepos)});